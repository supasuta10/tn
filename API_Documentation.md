# เอกสาร API สำหรับบริการ Chai Charoen Catering

## สารบัญ
- [ภาพรวม](#overview)
- [URL หลัก](#base-url)
- [การยืนยันตัวตน](#authentication)
- [จุดเชื่อมต่อ API](#endpoints)
  - [การยืนยันตัวตน](#authentication-endpoints)
  - [ผู้ใช้งาน](#user-endpoints)
  - [เมนูอาหาร](#menu-endpoints)
  - [แพ็คเกจเมนู](#menu-package-endpoints)
  - [การจอง](#booking-endpoints)
  - [รีวิว](#review-endpoints)
  - [แดชบอร์ดลูกค้า](#customer-dashboard-endpoints)
  - [แดชบอร์ดแอดมิน](#admin-dashboard-endpoints)
  - [สลิปการชำระเงิน](#payment-slip-endpoints)
- [รูปแบบการตอบกลับ](#response-format)
- [การจัดการข้อผิดพลาด](#error-handling)

## ภาพรวม
API นี้ให้บริการสำหรับร้าน Chai Charoen Catering ช่วยให้ลูกค้าสามารถเรียกดูเมนูอาหาร ทำการจอง และจัดการข้อมูลส่วนตัว ผู้ดูแลระบบสามารถจัดการระบบผ่านจุดเชื่อมต่อที่กำหนดเฉพาะ

## URL หลัก
```
http://localhost:8080/api
```
*หมายเหตุ: แทนที่ด้วย URL จริงของระบบในการใช้งานจริง*

## การยืนยันตัวตน
จุดเชื่อมต่อส่วนใหญ่จำเป็นต้องมีการยืนยันตัวตนโดยใช้โทเค็น JWT ให้รวมโทเค็นในส่วนหัวของคำขอ (Authorization header):
```
Authorization: Bearer <jwt_token>
```

จุดเชื่อมต่อบางจุดต้องการสิทธิ์ผู้ดูแลระบบ ซึ่งจะถูกตรวจสอบเพิ่มเติมจากการยืนยันตัวตน

---

## จุดเชื่อมต่อ API

### จุดเชื่อมต่อสำหรับการยืนยันตัวตน

#### ลงทะเบียนผู้ใช้งาน
- **POST** `/auth/register`
- **คำอธิบาย:** ลงทะเบียนบัญชีผู้ใช้งานใหม่
- **ต้องการการยืนยันตัวตน:** ไม่ต้อง
- **ข้อมูลที่ส่งเข้ามา (Request Body):**
```json
{
  "name": "string",
  "email": "string",
  "password": "string",
  "role": "string" // ตัวเลือก ค่าเริ่มต้นเป็น 'customer'
}
```
- **การตอบกลับ:**
```json
{
  "message": "string",
  "user": "user_object",
  "token": "string"
}
```

#### เข้าสู่ระบบผู้ใช้งาน
- **POST** `/auth/login`
- **คำอธิบาย:** ยืนยันตัวตนและเข้าสู่ระบบผู้ใช้งาน
- **ต้องการการยืนยันตัวตน:** ไม่ต้อง
- **ข้อมูลที่ส่งเข้ามา (Request Body):**
```json
{
  "email": "string",
  "password": "string"
}
```
- **การตอบกลับ:**
```json
{
  "message": "string",
  "user": "user_object",
  "token": "string"
}
```

---

### จุดเชื่อมต่อสำหรับผู้ใช้งาน

#### ดูข้อมูลส่วนตัวของฉัน
- **GET** `/users/me`
- **คำอธิบาย:** ดึงข้อมูลโปรไฟล์ของผู้ใช้งานที่ยืนยันตัวตนแล้ว
- **ต้องการการยืนยันตัวตน:** ต้องการ
- **การตอบกลับ:**
```json
{
  "user": "user_object"
}
```

#### อัปเดตข้อมูลส่วนตัวของฉัน
- **PUT** `/users/me`
- **คำอธิบาย:** อัปเดตข้อมูลโปรไฟล์ของผู้ใช้งานที่ยืนยันตัวตนแล้ว
- **ต้องการการยืนยันตัวตน:** ต้องการ
- **ข้อมูลที่ส่งเข้ามา (Request Body):**
```json
{
  "name": "string",
  "email": "string",
  "password": "string" // ตัวเลือก
}
```
- **การตอบกลับ:**
```json
{
  "message": "string",
  "user": "user_object"
}
```

#### ดูผู้ใช้งานทั้งหมด (เฉพาะแอดมิน)
- **GET** `/users/all`
- **คำอธิบาย:** ดึงข้อมูลผู้ใช้งานทั้งหมดในระบบ
- **ต้องการการยืนยันตัวตน:** ต้องการ (แอดมิน)
- **การตอบกลับ:**
```json
{
  "users": ["user_objects"]
}
```

#### ค้นหาผู้ใช้งานตามบทบาท (เฉพาะแอดมิน)
- **GET** `/users/search?role={role}`
- **คำอธิบาย:** ค้นหาผู้ใช้งานตามบทบาท
- **ต้องการการยืนยันตัวตน:** ต้องการ (แอดมิน)
- **พารามิเตอร์ใน URL:**
  - `role`: บทบาทที่ต้องการค้นหา
- **การตอบกลับ:**
```json
{
  "users": ["user_objects"]
}
```

#### ดูข้อมูลผู้ใช้งานตาม ID (เฉพาะแอดมิน)
- **GET** `/users/{id}`
- **คำอธิบาย:** ดึงข้อมูลผู้ใช้งานตาม ID
- **ต้องการการยืนยันตัวตน:** ต้องการ (แอดมิน)
- **พารามิเตอร์ใน URL:**
  - `id`: ID ของผู้ใช้งาน
- **การตอบกลับ:**
```json
{
  "user": "user_object"
}
```

#### อัปเดตข้อมูลผู้ใช้งานตาม ID (เฉพาะแอดมิน)
- **PUT** `/users/{id}`
- **คำอธิบาย:** อัปเดตข้อมูลผู้ใช้งานตาม ID
- **ต้องการการยืนยันตัวตน:** ต้องการ (แอดมิน)
- **พารามิเตอร์ใน URL:**
  - `id`: ID ของผู้ใช้งาน
- **ข้อมูลที่ส่งเข้ามา (Request Body):**
```json
{
  "name": "string",
  "email": "string",
  "role": "string",
  "isActive": "boolean"
}
```
- **การตอบกลับ:**
```json
{
  "message": "string",
  "user": "user_object"
}
```

#### ลบผู้ใช้งานตาม ID (เฉพาะแอดมิน)
- **DELETE** `/users/{id}`
- **คำอธิบาย:** ลบผู้ใช้งานตาม ID
- **ต้องการการยืนยันตัวตน:** ต้องการ (แอดมิน)
- **พารามิเตอร์ใน URL:**
  - `id`: ID ของผู้ใช้งาน
- **การตอบกลับ:**
```json
{
  "message": "string"
}
```

---

### จุดเชื่อมต่อสำหรับเมนูอาหาร

#### สร้างรายการเมนู
- **POST** `/menus`
- **คำอธิบาย:** สร้างรายการเมนูใหม่พร้อมรูปภาพ (ตัวเลือก)
- **ต้องการการยืนยันตัวตน:** ต้องการ (แอดมิน)
- **ข้อมูลที่ส่งเข้ามา (Form Data):**
  - `name`: ชื่อเมนู (string)
  - `description`: รายละเอียดเมนู (string)
  - `price`: ราคา (number)
  - `category`: หมวดหมู่ (string)
  - `image`: ไฟล์รูปภาพ (ตัวเลือก)
- **การตอบกลับ:**
```json
{
  "message": "string",
  "menu": "menu_object"
}
```

#### ดูเมนูทั้งหมด
- **GET** `/menus`
- **คำอธิบาย:** ดึงข้อมูลรายการเมนูทั้งหมด
- **ต้องการการยืนยันตัวตน:** ไม่ต้อง
- **การตอบกลับ:**
```json
{
  "menus": ["menu_objects"]
}
```

#### ดูเมนูตาม ID
- **GET** `/menus/{id}`
- **คำอธิบาย:** ดึงข้อมูลเมนูตาม ID
- **ต้องการการยืนยันตัวตน:** ไม่ต้อง
- **พารามิเตอร์ใน URL:**
  - `id`: ID เมนู
- **การตอบกลับ:**
```json
{
  "menu": "menu_object"
}
```

#### อัปเดตรายการเมนู
- **PUT** `/menus/{id}`
- **คำอธิบาย:** อัปเดตรายการเมนูพร้อมรูปภาพ (ตัวเลือก)
- **ต้องการการยืนยันตัวตน:** ต้องการ (แอดมิน)
- **พารามิเตอร์ใน URL:**
  - `id`: ID เมนู
- **ข้อมูลที่ส่งเข้ามา (Form Data):**
  - `name`: ชื่อเมนู (string)
  - `description`: รายละเอียดเมนู (string)
  - `price`: ราคา (number)
  - `category`: หมวดหมู่ (string)
  - `image`: ไฟล์รูปภาพ (ตัวเลือก)
- **การตอบกลับ:**
```json
{
  "message": "string",
  "menu": "menu_object"
}
```

#### ลบรายการเมนู
- **DELETE** `/menus/{id}`
- **คำอธิบาย:** ลบรายการเมนู
- **ต้องการการยืนยันตัวตน:** ต้องการ (แอดมิน)
- **พารามิเตอร์ใน URL:**
  - `id`: ID เมนู
- **การตอบกลับ:**
```json
{
  "message": "string"
}
```

#### เปิด/ปิดสถานะเมนู
- **PATCH** `/menus/{id}/toggle`
- **คำอธิบาย:** สลับสถานะการทำงานของรายการเมนู (ลบแบบซอฟต์ดีลีต)
- **ต้องการการยืนยันตัวตน:** ต้องการ (แอดมิน)
- **พารามิเตอร์ใน URL:**
  - `id`: ID เมนู
- **การตอบกลับ:**
```json
{
  "message": "string",
  "menu": "menu_object"
}
```

---

### จุดเชื่อมต่อสำหรับแพ็คเกจเมนู

#### สร้างแพ็คเกจเมนู
- **POST** `/menu-packages`
- **คำอธิบาย:** สร้างแพ็คเกจเมนูใหม่
- **ต้องการการยืนยันตัวตน:** ต้องการ (แอดมิน)
- **ข้อมูลที่ส่งเข้ามา (Request Body):**
```json
{
  "packageName": "string",
  "description": "string",
  "price": "number",
  "menuItems": ["menu_item_ids"]
}
```
- **การตอบกลับ:**
```json
{
  "message": "string",
  "menuPackage": "menu_package_object"
}
```

#### ดูแพ็คเกจเมนูทั้งหมด
- **GET** `/menu-packages`
- **คำอธิบาย:** ดึงข้อมูลแพ็คเกจเมนูทั้งหมด
- **ต้องการการยืนยันตัวตน:** ไม่ต้อง
- **การตอบกลับ:**
```json
{
  "menuPackages": ["menu_package_objects"]
}
```

#### ดูแพ็คเกจเมนูตาม ID
- **GET** `/menu-packages/{id}`
- **คำอธิบาย:** ดึงข้อมูลแพ็คเกจเมนูตาม ID
- **ต้องการการยืนยันตัวตน:** ไม่ต้อง
- **พารามิเตอร์ใน URL:**
  - `id`: ID แพ็คเกจเมนู
- **การตอบกลับ:**
```json
{
  "menuPackage": "menu_package_object"
}
```

#### อัปเดตแพ็คเกจเมนู
- **PUT** `/menu-packages/{id}`
- **คำอธิบาย:** อัปเดตแพ็คเกจเมนู
- **ต้องการการยืนยันตัวตน:** ต้องการ (แอดมิน)
- **พารามิเตอร์ใน URL:**
  - `id`: ID แพ็คเกจเมนู
- **ข้อมูลที่ส่งเข้ามา (Request Body):**
```json
{
  "packageName": "string",
  "description": "string",
  "price": "number",
  "menuItems": ["menu_item_ids"]
}
```
- **การตอบกลับ:**
```json
{
  "message": "string",
  "menuPackage": "menu_package_object"
}
```

#### ลบแพ็คเกจเมนู
- **DELETE** `/menu-packages/{id}`
- **คำอธิบาย:** ลบแพ็คเกจเมนู
- **ต้องการการยืนยันตัวตน:** ต้องการ (แอดมิน)
- **พารามิเตอร์ใน URL:**
  - `id`: ID แพ็คเกจเมนู
- **การตอบกลับ:**
```json
{
  "message": "string"
}
```

---

### จุดเชื่อมต่อสำหรับการจอง

#### สร้างการจอง
- **POST** `/bookings`
- **คำอธิบาย:** สร้างการจองใหม่
- **ต้องการการยืนยันตัวตน:** ต้องการ
- **ข้อมูลที่ส่งเข้ามา (Request Body):**
```json
{
  "eventDate": "date",
  "eventType": "string",
  "guestCount": "number",
  "location": "string",
  "menuPackageId": "string",
  "specialRequests": "string"
}
```
- **การตอบกลับ:**
```json
{
  "message": "string",
  "booking": "booking_object"
}
```

#### ดูการจองทั้งหมด (เฉพาะแอดมิน)
- **GET** `/bookings`
- **คำอธิบาย:** ดึงข้อมูลการจองทั้งหมดในระบบ
- **ต้องการการยืนยันตัวตน:** ต้องการ (แอดมิน)
- **การตอบกลับ:**
```json
{
  "bookings": ["booking_objects"]
}
```

#### ตรวจสอบวันที่สามารถจองได้
- **GET** `/bookings/availability`
- **คำอธิบาย:** ตรวจสอบวันที่ว่างสำหรับการจองใหม่
- **ต้องการการยืนยันตัวตน:** ไม่ต้อง
- **พารามิเตอร์ใน URL:**
  - `date`: วันที่ต้องการตรวจสอบความว่าง (ตัวเลือก)
- **การตอบกลับ:**
```json
{
  "isAvailable": "boolean",
  "bookedDates": ["date_strings"]
}
```

#### ดูการจองตาม ID
- **GET** `/bookings/{id}`
- **คำอธิบาย:** ดึงข้อมูลการจองตาม ID
- **ต้องการการยืนยันตัวตน:** ต้องการ (เจ้าของหรือแอดมิน)
- **พารามิเตอร์ใน URL:**
  - `id`: ID การจอง
- **การตอบกลับ:**
```json
{
  "booking": "booking_object"
}
```

#### อัปเดตสถานะการจอง (เฉพาะแอดมิน)
- **PUT** `/bookings/{id}/status`
- **คำอธิบาย:** อัปเดตสถานะการจอง
- **ต้องการการยืนยันตัวตน:** ต้องการ (แอดมิน)
- **พารามิเตอร์ใน URL:**
  - `id`: ID การจอง
- **ข้อมูลที่ส่งเข้ามา (Request Body):**
```json
{
  "status": "string" // pending, confirmed, cancelled, completed
}
```
- **การตอบกลับ:**
```json
{
  "message": "string",
  "booking": "booking_object"
}
```

#### ลบการจอง (เฉพาะแอดมิน)
- **DELETE** `/bookings/{id}`
- **คำอธิบาย:** ลบการจอง
- **ต้องการการยืนยันตัวตน:** ต้องการ (แอดมิน)
- **พารามิเตอร์ใน URL:**
  - `id`: ID การจอง
- **การตอบกลับ:**
```json
{
  "message": "string"
}
```

---

### จุดเชื่อมต่อสำหรับรีวิว

#### สร้างรีวิว
- **POST** `/reviews`
- **คำอธิบาย:** สร้างรีวิวใหม่
- **ต้องการการยืนยันตัวตน:** ต้องการ
- **ข้อมูลที่ส่งเข้ามา (Request Body):**
```json
{
  "bookingId": "string",
  "rating": "number",
  "comment": "string"
}
```
- **การตอบกลับ:**
```json
{
  "message": "string",
  "review": "review_object"
}
```

#### ดูรีวิวทั้งหมด
- **GET** `/reviews`
- **คำอธิบาย:** ดึงข้อมูลรีวิวทั้งหมด
- **ต้องการการยืนยันตัวตน:** ไม่ต้อง
- **การตอบกลับ:**
```json
{
  "reviews": ["review_objects"]
}
```

#### ดูคะแนนเฉลี่ย
- **GET** `/reviews/average-rating`
- **คำอธิบาย:** ดึงคะแนนเฉลี่ยจากทุกรีวิว
- **ต้องการการยืนยันตัวตน:** ไม่ต้อง
- **การตอบกลับ:**
```json
{
  "averageRating": "number"
}
```

#### ดูรีวิวตามลูกค้า
- **GET** `/reviews/customer/{customerID}`
- **คำอธิบาย:** ดึงข้อมูลรีวิวจากลูกค้าเฉพาะเจาะจง
- **ต้องการการยืนยันตัวตน:** ต้องการ
- **พารามิเตอร์ใน URL:**
  - `customerID`: ID ลูกค้า
- **การตอบกลับ:**
```json
{
  "reviews": ["review_objects"]
}
```

#### ดูรีวิวตามการจอง
- **GET** `/reviews/booking/{bookingID}`
- **คำอธิบาย:** ดึงข้อมูลรีวิวสำหรับการจองเฉพาะเจาะจง
- **ต้องการการยืนยันตัวตน:** ไม่ต้อง
- **พารามิเตอร์ใน URL:**
  - `bookingID`: ID การจอง
- **การตอบกลับ:**
```json
{
  "reviews": ["review_objects"]
}
```

#### ดูรีวิวตาม ID
- **GET** `/reviews/{id}`
- **คำอธิบาย:** ดึงข้อมูลรีวิวตาม ID
- **ต้องการการยืนยันตัวตน:** ไม่ต้อง
- **พารามิเตอร์ใน URL:**
  - `id`: ID รีวิว
- **การตอบกลับ:**
```json
{
  "review": "review_object"
}
```

#### อัปเดตรีวิว
- **PUT** `/reviews/{id}`
- **คำอธิบาย:** อัปเดตรีวิว
- **ต้องการการยืนยันตัวตน:** ต้องการ (เจ้าของ)
- **พารามิเตอร์ใน URL:**
  - `id`: ID รีวิว
- **ข้อมูลที่ส่งเข้ามา (Request Body):**
```json
{
  "rating": "number",
  "comment": "string"
}
```
- **การตอบกลับ:**
```json
{
  "message": "string",
  "review": "review_object"
}
```

#### ลบรีวิว
- **DELETE** `/reviews/{id}`
- **คำอธิบาย:** ลบรีวิว
- **ต้องการการยืนยันตัวตน:** ต้องการ (เจ้าของ)
- **พารามิเตอร์ใน URL:**
  - `id`: ID รีวิว
- **การตอบกลับ:**
```json
{
  "message": "string"
}
```

---

### จุดเชื่อมต่อสำหรับแดชบอร์ดลูกค้า

#### ดูสรุปแดชบอร์ดลูกค้า
- **GET** `/customer/dashboard`
- **คำอธิบาย:** ดึงข้อมูลสรุปแดชบอร์ดลูกค้า
- **ต้องการการยืนยันตัวตน:** ต้องการ
- **การตอบกลับ:**
```json
{
  "summary": {
    "totalBookings": "number",
    "upcomingEvents": ["booking_objects"],
    "recentReviews": ["review_objects"]
  }
}
```

#### ดูการจองของลูกค้า
- **GET** `/customer/bookings`
- **คำอธิบาย:** ดึงข้อมูลการจองของลูกค้า
- **ต้องการการยืนยันตัวตน:** ต้องการ
- **การตอบกลับ:**
```json
{
  "bookings": ["booking_objects"]
}
```

#### ดูข้อมูลโปรไฟล์ลูกค้า
- **GET** `/customer/profile`
- **คำอธิบาย:** ดึงข้อมูลโปรไฟล์ลูกค้า
- **ต้องการการยืนยันตัวตน:** ต้องการ
- **การตอบกลับ:**
```json
{
  "customer": "customer_object"
}
```

#### อัปเดตข้อมูลโปรไฟล์ลูกค้า
- **PUT** `/customer/profile`
- **คำอธิบาย:** อัปเดตข้อมูลโปรไฟล์ลูกค้า
- **ต้องการการยืนยันตัวตน:** ต้องการ
- **ข้อมูลที่ส่งเข้ามา (Request Body):**
```json
{
  "name": "string",
  "email": "string",
  "phone": "string",
  "address": "string"
}
```
- **การตอบกลับ:**
```json
{
  "message": "string",
  "customer": "customer_object"
}
```

#### ยกเลิกการจองของลูกค้า
- **DELETE** `/customer/booking/{id}`
- **คำอธิบาย:** ยกเลิกการจองของลูกค้า
- **ต้องการการยืนยันตัวตน:** ต้องการ
- **พารามิเตอร์ใน URL:**
  - `id`: ID การจอง
- **การตอบกลับ:**
```json
{
  "message": "string"
}
```

#### ส่งสลิปการชำระเงินสำหรับการจอง
- **POST** `/customer/booking/{id}/payment`
- **คำอธิบาย:** ส่งสลิปการชำระเงินสำหรับการจอง
- **ต้องการการยืนยันตัวตน:** ต้องการ
- **พารามิเตอร์ใน URL:**
  - `id`: ID การจอง
- **ข้อมูลที่ส่งเข้ามา (Form Data):**
  - `file`: ไฟล์รูปภาพสลิปการชำระเงิน
- **การตอบกลับ:**
```json
{
  "message": "string",
  "payment": "payment_object"
}
```

---

### จุดเชื่อมต่อสำหรับแดชบอร์ดแอดมิน

#### ดูสรุปแดชบอร์ดแอดมิน
- **GET** `/admin/dashboard`
- **คำอธิบาย:** ดึงข้อมูลสรุปแดชบอร์ดแอดมิน
- **ต้องการการยืนยันตัวตน:** ต้องการ (แอดมิน)
- **การตอบกลับ:**
```json
{
  "summary": {
    "totalUsers": "number",
    "totalBookings": "number",
    "totalRevenue": "number",
    "recentActivities": ["activity_objects"]
  }
}
```

#### ดูข้อมูลวิเคราะห์
- **GET** `/admin/analytics`
- **คำอธิบาย:** ดึงข้อมูลสำหรับการวิเคราะห์
- **ต้องการการยืนยันตัวตน:** ต้องการ (แอดมิน)
- **การตอบกลับ:**
```json
{
  "analytics": {
    "monthlyRevenue": ["data_objects"],
    "popularMenus": ["menu_objects"],
    "bookingTrends": ["trend_objects"]
  }
}
```

#### ดูรายงาน
- **GET** `/admin/reports`
- **คำอธิบาย:** ดึงข้อมูลรายงานของระบบ
- **ต้องการการยืนยันตัวตน:** ต้องการ (แอดมิน)
- **การตอบกลับ:**
```json
{
  "reports": ["report_objects"]
}
```

---

### จุดเชื่อมต่อสำหรับสลิปการชำระเงิน

#### อัปโหลดสลิปการชำระเงิน
- **POST** `/payment-slips/upload`
- **คำอธิบาย:** อัปโหลดสลิปการชำระเงิน
- **ต้องการการยืนยันตัวตน:** ต้องการ
- **ข้อมูลที่ส่งเข้ามา (Form Data):**
  - `slip`: ไฟล์รูปภาพหรือ PDF ของสลิปการชำระเงิน
- **การตอบกลับ:**
```json
{
  "message": "string",
  "filePath": "string",
  "filename": "string"
}
```

---

## รูปแบบการตอบกลับ

การตอบกลับที่สำเร็จจะมีรูปแบบดังนี้:
```json
{
  "message": "ข้อความแจ้งผลสำเร็จ",
  "data": { /* ข้อมูลที่ส่งกลับ */ }
}
```

## การจัดการข้อผิดพลาด

การตอบกลับเมื่อเกิดข้อผิดพลาดจะมีรูปแบบดังนี้:
```json
{
  "message": "ข้อความแจ้งข้อผิดพลาด",
  "error": "ข้อมูลรายละเอียดข้อผิดพลาด"
}
```

รหัสสถานะ HTTP ที่ใช้บ่อย:
- `200` - สำเร็จ
- `201` - สร้างเรียบร้อย
- `400` - คำขอไม่ถูกต้อง
- `401` - ไม่ได้รับอนุญาต
- `403` - ไม่ได้รับสิทธิ์เข้าถึง
- `404` - ไม่พบข้อมูล
- `500` - เกิดข้อผิดพลาดภายในเซิร์ฟเวอร์